# This conf file is based on accepting logs for smtp.log from Bro systems
filter {
  if [type] == "bro_smtp" {
    mutate {
      #rename => { "ts" => "timestamp" }
      #uid
      #rename => { "id.orig_h" => "source_ip" }
      #rename => { "id.orig_p" => "source_port" }
      #rename => { "id.resp_h" => "destination_ip" }
      #rename => { "id.resp_p" => "destination_port" }
      #trans_depth
      #helo
      rename => { "mailfrom" => "mail_from" }
      rename => { "rcptto" => "recipient_to" }
      rename => { "date" => "mail_date" }
      #from
      #to
      #cc
      #reply_to
      rename => { "msg_id" => "message_id" }
      #in_reply_to
      #subject
      #x_originating_ip
      #first_received
      #second_received
      #last_reply
      #path
      rename => { "user_agent" => "useragent" }
      #tls
      #fuids
      #is_webmail
    }

    mutate {
      convert => { "tls" => "string" }
      convert => { "is_webmail" => "string" }
    }
  }
}
