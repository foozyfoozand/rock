# This conf file is based on accepting logs for software.log from Bro systems
filter {
  if [type] == "bro_software" {
    mutate {
      #rename => { "ts" => "timestamp" }
      #uid
      rename => { "host" => "source_ip" }
      rename => { "host_p" => "source_port" }
      #software_type
      #name
      rename => { "version.major" => "version_major" }
      rename => { "version.minor" => "version_minor" }
      rename => { "version.minor2" => "version_minor2" }
      rename => { "version.minor3" => "version_minor3" }
      rename => { "version.addl" => "version_additional_info" }
      #unparsed_version
    }

    mutate {
      convert => { "version_major" => "string" }
      convert => { "version_minor" => "string" }
    }
  }
}
