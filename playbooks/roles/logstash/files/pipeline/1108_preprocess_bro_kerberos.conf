# This conf file is based on accepting logs for kerberos.log from Bro systems
filter {
  if [type] == "bro_kerberos" {
    mutate {
      #rename => { "ts" => "timestamp" }
      #uid
      #rename => { "id.orig_h" => "source_ip" }
      #rename => { "id.orig_p" => "source_port" }
      #rename => { "id.resp_h" => "destination_ip" }
      #rename => { "id.resp_p" => "destination_port" }
      #request_type
      #client
      #service
      rename => { "success" => "kerberos_success" }
      rename => { "error_msg" => "error_message" }
      rename => { "from" => "valid_from" }
      rename => { "till" => "valid_till" }
      #cipher
      #forwardable
      #renewable
      rename => { "client_cert_subject" => "client_certificate_subject" }
      rename => { "client_cert_fuid" => "client_certificate_fuid" }
      rename => { "server_cert_subject" => "server_certificate_subject" }
      rename => { "server_cert_fuid" => "server_certificate_fuid" }
    }

    mutate {
      convert => { "kerberos_success" => "string" }
      convert => { "renewable" => "string" }
    }
  }
}
