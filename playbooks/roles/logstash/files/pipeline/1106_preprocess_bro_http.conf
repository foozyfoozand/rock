# This conf file is based on accepting logs for http.log from Bro systems
filter {
  if [type] == "bro_http" {
    mutate {
      #rename => { "ts" => "timestamp" }
      #uid
      #rename => { "id.orig_h" => "source_ip" }
      #rename => { "id.orig_p" => "source_port" }
      #rename => { "id.resp_h" => "destination_ip" }
      #rename => { "id.resp_p" => "destination_port" }
      #trans_depth
      #method
      rename => { "host" => "virtual_host" }
      #uri
      #referrer
      #version
      #convert => { "version" => "string" }
      rename => { "user_agent" => "useragent" }
      rename => { "request_body_len" => "request_body_length" }
      rename => { "response_body_len" => "response_body_length" }
      #status_code
      #status_message
      rename => { "status_msg" => "status_message" }
      #info_code
      rename => { "info_msg" => "info_message" }
      #tags
      # Rename http tags field to http-tags
      rename => { "tags-bro" => "http-tags" }
      rename => { "username" => "user" }
      #password
      #proxied
      #orig_fuids
      #orig_filenames
      #orig_mime_types
      #resp_fuids
      #resp_filenames
      #resp_mime_types
    }

    if [http-tags] {
      mutate {
        remove_field => [ "http-tags" ]
      }
    }
  }
}
