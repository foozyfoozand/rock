# This conf file is based on accepting logs for dns.log from Bro systems
filter {
  if [type] == "bro_dns" {
    mutate {
      #rename => { "ts" => "timestamp" }
      #uid
      #rename => { "id.orig_h" => "source_ip" }
      #rename => { "id.orig_p" => "source_port" }
      #rename => { "id.resp_h" => "destination_ip" }
      #rename => { "id.resp_p" => "destination_port" }
      rename => { "proto" => "protocol" }
      rename => { "trans_id" => "transaction_id" }
      #rtt field
      #query field
      rename => { "qclass" => "query_class" }
      rename => { "qclass_name" => "query_class_name" }
      rename => { "qtype" => "query_type" }
      rename => { "qtype_name" => "query_type_name" }
      #rcode
      #rcode_name
      rename => { "AA" => "aa" }
      rename => { "TC" => "tc" }
      rename => { "RD" => "rd" }
      rename => { "RA" => "ra" }
      rename => { "Z" => "z" }
      #answers
      rename => { "TTLs" => "ttls" }
      #rejected
    }

    mutate {
      add_tag => [ "dns" ]
    }
  }
}
